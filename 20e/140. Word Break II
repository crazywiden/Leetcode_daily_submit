# solution: dfs + memory
# time complexity: O(m*n^2), 56 ms, 53.02%
# space complexity: O(n^2), 13.5 MB, 50.21%
class Solution:
    def wordBreak(self, s: str, wordDict: List[str]) -> List[str]:
        res = []
        memo = {}
        return dfs(s, memo, wordDict)
    
def dfs(s, memo, wordDict):
    if s in memo:
        return memo[s]
    if s == '':
        return []
    res = []
    for word in wordDict:
        if not s.startswith(word):
            continue
        if len(word) == len(s):
            res.append(word)
        else:
            rest = dfs(s[len(word):], memo, wordDict)
            for item in rest:
                item = word + ' ' + item
                res.append(item)
    memo[s] = res
    return res
